(this["webpackJsonphabit-tracker-sber-app-frontend"]=this["webpackJsonphabit-tracker-sber-app-frontend"]||[]).push([[0],{161:function(t,e,n){"use strict";n.r(e);var a,r=n(0),c=n.n(r),i=n(17),o=n.n(i),s=n(67),u=n(6),b=n(1),d=n(60),l=n(2),j=n(3),p=Object(b.createGlobalStyle)(a||(a=Object(u.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),l.text,l.background,l.gradient),f=Object(b.createGlobalStyle)(d.darkSber),O=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(p,{}),Object(j.jsx)(f,{})]})},h=n(9),m=n.n(h),x=n(14),g=n(13),v=n(16),y=n.n(v),k="https://thawing-earth-86187.herokuapp.com/";function w(t,e,n,a,r){return C.apply(this,arguments)}function C(){return(C=Object(x.a)(m.a.mark((function t(e,n,a,r,c){var i,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.post(k+"user/",{UserId:e,SberId:n,Name:a,Age:r,Gender:c});case 2:return i=t.sent,o=i.data,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(){return(H=Object(x.a)(m.a.mark((function t(e,n,a){var r,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.post(k+"habit",{UserId:e,Name:n,DateForEnd:a});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(t){return A.apply(this,arguments)}function A(){return(A=Object(x.a)(m.a.mark((function t(e){var n,a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.get(k+"habit/",{params:{UserId:e}});case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function D(){return(D=Object(x.a)(m.a.mark((function t(e){var n,a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.delete(k+"habit?HabitId="+"".concat(e));case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return(I=Object(x.a)(m.a.mark((function t(e,n){var a,r,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={HabitId:e,DateOfActivity:n},console.log("body:",a),t.next=4,y.a.post(k+"activity",a);case 4:return r=t.sent,c=r.data,t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function N(){return(N=Object(x.a)(m.a.mark((function t(e,n){var a,r,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={HabitId:e,DateOfActivity:n},console.log("body:",a),t.next=4,y.a.delete("".concat(k,"activity?HabitId=").concat(e,"&DateOfActivity=").concat(n));case 4:return r=t.sent,c=r.data,t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var T,_,B,F,z,E,U,P,R,L,V,G,J,Z,M,Y=n(18),q=n(5),K=n(12),Q=Object(b.default)(Y.Row)(T||(T=Object(u.a)(["\n  margin: 2rem 0;\n"]))),W=b.default.div(_||(_=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n"]))),X=b.default.div(B||(B=Object(u.a)(["\n  display: flex;\n  margin-top: 1rem;\n  padding-right: 1rem;\n"]))),$=b.default.div(F||(F=Object(u.a)(["\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  @media only screen and (max-width: 600px) {\n    right: 0rem;\n  }\n"]))),tt=Object(b.default)(q.CardContent)(z||(z=Object(u.a)(["\n  position: relative;\n"]))),et=Object(b.default)(q.TextBox)(E||(E=Object(u.a)(["\n  margin-bottom: 1rem;\n  text-align: center;\n"]))),nt=Object(b.default)(q.Card)(U||(U=Object(u.a)(["\n  margin: 1.5rem 2rem 0;\n  :last-of-type {\n    margin-bottom: 10rem;\n\n  }\n  @media only screen and (max-width: 600px) {\n    margin: 1rem 0rem 1rem 0;\n    padding-right: 1rem;\n  }\n"]))),at=function(t){for(var e=t.habitId,n=t.habitName,a=t.progressValue,r=t.maxValue,c=t.deleteHabit,i=t.habitProgress,o=t.updateActivity,s="".concat(a,"/").concat(r),u=new Date,b=["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],d=[],l=function(t){return"0".concat(t).slice(-2)},p=0;p<5;++p){var f=l(u.getDate()),O=l(u.getMonth()+1),h=u.getFullYear()+"-"+O+"-"+f+"T19:47:00.571Z";d.push([p,h,b[u.getDay()]]),u=new Date(u.getTime()-864e5)}return d=d.reverse(),Object(j.jsx)(nt,{children:Object(j.jsx)(q.CardBody,{children:Object(j.jsxs)(tt,{children:[Object(j.jsx)(q.Container,{children:Object(j.jsxs)(Q,{children:[Object(j.jsx)(q.Col,{type:"calc",size:6,children:Object(j.jsx)(q.TextBox,{size:"l",subTitle:s,title:n})}),Object(j.jsx)(X,{children:d.map((function(t){return Object(j.jsxs)(q.Col,{type:"calc",size:.9,children:[Object(j.jsx)(et,{size:"m",title:t[1].slice(5,10),subTitle:t[2]}),Object(j.jsx)(W,{children:Object(j.jsx)(q.Checkbox,{checked:void 0!=i?i[t[0]]:1,onChange:function(n){return o(e,t[1],n.target.checked)}})})]},t[0])}))})]})}),Object(j.jsx)($,{onClick:function(){c(e)},children:Object(j.jsx)(K.h,{})})]})})})},rt=Object(b.default)(q.TextField)(P||(P=Object(u.a)(["\n  flex-grow: 1;\n  margin-right: 1rem;\n"]))),ct=Object(b.default)(q.Card)(R||(R=Object(u.a)(["\n\n  width: 50%;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  padding: 2rem;\n  background-color: ",";\n  background-image: ",";\n  @media only screen and (max-width: 900px) {\n    width: 90%;\n  }\n\n"])),l.background,l.gradient),it=b.default.div(L||(L=Object(u.a)(["\n  display: flex;\n  margin: 2.5rem 0;\n  @media only screen and (max-width: 600px) {\n    margin: 1rem 0;\n  }\n"]))),ot=Object(b.default)(q.TextBox)(V||(V=Object(u.a)(["\n  margin-bottom: 0.5rem;\n"]))),st=function(t){var e=t.setPopupActive,n=t.createHabitCountState,a=t.createHabitNameState,r=t.setCreateHabitNameState,c=t.setCreateHabitCountState,i=(t.createHabitName,t.createHabbitAction);return Object(j.jsx)(ct,{children:Object(j.jsx)(q.CardBody,{children:Object(j.jsxs)(q.CardContent,{children:[Object(j.jsx)(q.TextBox,{size:"l",title:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438"}),Object(j.jsxs)(it,{children:[Object(j.jsx)(rt,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438",value:a,onChange:function(t){r(t.target.value)}}),Object(j.jsxs)("div",{children:[Object(j.jsx)(ot,{size:"m",subTitle:"\u0412\u0440\u0435\u043c\u044f \u0432\u044b\u0440\u0430\u0431\u043e\u0442\u043a\u0438"}),Object(j.jsx)(q.Stepper,{step:1,value:n,onChange:function(t){c(t)}})]})]}),Object(j.jsx)(q.Button,{text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",view:"primary",onClick:function(){a&&(e(!1),i())}})]})})})},ut=function(t){var e=t.onClick;return Object(j.jsx)(q.Button,{text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onClick:e,view:"clear"})},bt=(b.default.div(G||(G=Object(u.a)(["\n    filter: blur(8px);\n    -webkit-filter: blur(8px);  \n"]))),b.default.div(J||(J=Object(u.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 4rem;\n    position: sticky;\n    top: 0;\n    background-color: rgba(0,0,0,.6);\n    -webkit-backdrop-filter: blur(10px);\n    backdrop-filter: blur(10px);\n    @media only screen and (max-width: 600px) {\n        padding: 1rem 1rem;\n    }\n    "])))),dt=b.default.div(Z||(Z=Object(u.a)(["\n    height: 100vh;\n    width: 100vw;\n    background-color: rgba(0,0,0,.6);\n    position: fixed;\n    top: 0;\n    left: 0; \n"]))),lt=b.default.div(M||(M=Object(u.a)(["\n  position: absolute;\n  top:1rem;\n  right:1rem;\n"]))),jt=n(66);var pt=function(){var t={notes:[]},e=Object(r.useState)(!1),n=Object(g.a)(e,2),a=n[0],i=n[1],o=Object(r.useRef)("1234555"),s=Object(r.useState)(0),u=Object(g.a)(s,2),b=u[0],d=(u[1],Object(r.useState)("\u041a\u0438\u0440\u0438\u043b\u043b1")),l=Object(g.a)(d,2),p=l[0],f=(l[1],Object(r.useState)(20)),O=Object(g.a)(f,2),h=O[0],v=(O[1],Object(r.useState)("\u041c")),y=Object(g.a)(v,2),k=y[0],C=(y[1],Object(r.useRef)("")),A=Object(r.useRef)(""),T=Object(r.useState)(""),_=Object(g.a)(T,2),B=_[0],F=_[1],z=Object(r.useState)(66),E=Object(g.a)(z,2),U=E[0],P=E[1],R=Object(r.useState)([]),L=Object(g.a)(R,2),V=L[0],G=L[1],J=Object(r.useState)([!1,!0,!1,!1,!1]),Z=Object(g.a)(J,2),M=(Z[0],Z[1],Object(r.useRef)());Object(r.useEffect)((function(){var t;M.current=(t=function(){return W()},Object(jt.a)({getState:t})),M.current.on("start",(function(t){console.log("assistant.on(start)",t)})),M.current.on("data",(function(t){"smart_app_data"==t.type&&(console.log("User"),console.log(t),void 0!=t.sub?(console.log("Sub",t.sub),o.current=t.sub,w(t.sub,b,p,h,k),S(t.sub).then((function(t){G(t)}))):void 0!=t.user_id&&(console.log("UserId",t.user_id),o.current=t.user_id,w(t.userId,b,p,h,k),S(t.user_id).then((function(t){G(t)})))),console.log("assistant.on(data)",t);var e=t.action;Y(e)}))}),[]),Object(r.useEffect)((function(){S(o.current).then((function(t){G(t)}))}),[o.current]),Object(r.useEffect)((function(){C.current=B}),[B]),Object(r.useEffect)((function(){A.current=U}),[U]);var Y=function(){var t=Object(x.a)(m.a.mark((function t(e){var n,r,c,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("dispatchAssistantAction",e),!e){t.next=28;break}t.t0=e.type,t.next="OpenCreateHabitForm"===t.t0?5:"setHabbitName"===t.t0?7:"setHabbitTime"===t.t0?10:"createHabit"===t.t0?12:"deleteHabit"===t.t0?13:"completeHabit"===t.t0?15:27;break;case 5:return i(!a),t.abrupt("break",28);case 7:return console.log(e.data),F(e.data),t.abrupt("break",28);case 10:return P(e.data),t.abrupt("break",28);case 12:C.current&&(i(!1),X());case 13:return Q(e.data),t.abrupt("break",28);case 15:if(n=e.date.year,r=e.date.month,c=e.date.day,o="",console.log(e.data),V.map((function(t,n){var a=t._id;t.Name.toLowerCase()==e.data.toLowerCase()&&(o=a,console.log("HabitId"))})),""!=o){t.next=25;break}return t.abrupt("return");case 25:tt(o,n+"-"+r+"-"+c+"T19:47:00.571Z",!0);case 26:case 27:return t.abrupt("break",28);case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Q=function(t){V.map((function(e,n){var a=e._id,r=e.Name;if(t.toLowerCase()==r.toLowerCase())return $(a),void M.current.sendData({action:{action_id:"successDelete"}})})),M.current.sendData({action:{action_id:"BadDelete"}})},W=function(){console.log("getStateForAssistant: state:",t);var e={item_selector:{items:t.notes.map((function(t,e){return{number:e+1,id:t.id,title:t.title}}))}};return console.log("getStateForAssistant: new_state:",e),e},X=function(){console.log("UserId",o.current),console.log("CreateHabit",C.current),console.log("Count",A),function(t,e,n){return H.apply(this,arguments)}(o.current,C.current,A.current).then((function(){return S(o.current).then((function(t){console.log(t),G(t),M.current.sendData({action:{action_id:"successAdd"}})}))})),C.current="",F(""),P(66),console.log(V)},$=function(t){(function(t){return D.apply(this,arguments)})(t).then((function(){return S(o.current).then((function(t){G(t)}))}))},tt=function(t,e,n){n?(function(t,e){return I.apply(this,arguments)}(t,e).then((function(){S(o.current).then((function(t){G(t)}))})),console.log("Add")):(function(t,e){return N.apply(this,arguments)}(t,e).then((function(){S(o.current).then((function(t){G(t)}))})),console.log("Delete"))};return Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsxs)(bt,{children:[Object(j.jsx)(q.TextBox,{size:"l",title:"\u0412\u0430\u0448\u0438 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438:"}),Object(j.jsx)(ut,{onClick:function(){i(!a),console.log(o.current)}})]}),V.map((function(t,e){var n=t._id,a=t.Name,r=t.DateForEnd,c=t.fivedays,i=t.progress;return Object(j.jsx)(at,{habitId:n,habitName:a,progressValue:i,maxValue:r,habitProgress:c,deleteHabit:$,updateActivity:tt})})),a?Object(j.jsxs)("div",{children:[Object(j.jsx)(dt,{onClick:function(){return i(!a)}}),Object(j.jsx)(st,{setPopupActive:i,setCreateHabitCountState:P,createHabitNameState:B,setCreateHabitNameState:F,createHabitCountState:U,createHabitName:C,createHabbitAction:X}),Object(j.jsx)(lt,{onClick:function(){return i(!a)},children:Object(j.jsx)(K.d,{})})]}):null]})};o.a.render(Object(j.jsxs)(s.DeviceThemeProvider,{children:[Object(j.jsx)(O,{}),Object(j.jsx)(pt,{})]}),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.f4e43189.chunk.js.map