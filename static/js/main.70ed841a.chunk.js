(this["webpackJsonphabit-tracker-sber-app-frontend"]=this["webpackJsonphabit-tracker-sber-app-frontend"]||[]).push([[0],{161:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(17),o=n.n(i),s=n(67),u=n(6),b=n(1),d=n(60),l=n(2),j=n(3),p=Object(b.createGlobalStyle)(a||(a=Object(u.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),l.text,l.background,l.gradient),f=Object(b.createGlobalStyle)(d.darkSber),m=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(p,{}),Object(j.jsx)(f,{})]})},h=n(9),O=n.n(h),x=n(14),g=n(13),v=n(16),y=n.n(v),k="https://thawing-earth-86187.herokuapp.com/";function w(e,t,n,a,r){return C.apply(this,arguments)}function C(){return(C=Object(x.a)(O.a.mark((function e(t,n,a,r,c){var i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post(k+"user/",{UserId:t,SberId:n,Name:a,Age:r,Gender:c});case 2:return i=e.sent,o=i.data,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(x.a)(O.a.mark((function e(t,n,a){var r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post(k+"habit",{UserId:t,Name:n,DateForEnd:a});case 2:return r=e.sent,c=r.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return A.apply(this,arguments)}function A(){return(A=Object(x.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(k+"habit/",{params:{UserId:t}});case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(x.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.delete(k+"habit?HabitId="+"".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(x.a)(O.a.mark((function e(t,n){var a,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={HabitId:t,DateOfActivity:n},console.log("body:",a),e.next=4,y.a.post(k+"activity",a);case 4:return r=e.sent,c=r.data,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(x.a)(O.a.mark((function e(t,n){var a,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={HabitId:t,DateOfActivity:n},console.log("body:",a),e.next=4,y.a.delete("".concat(k,"activity?HabitId=").concat(t,"&DateOfActivity=").concat(n));case 4:return r=e.sent,c=r.data,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T,_,B,F,z,E,U,P,R,L,V,G,J,Z,M,Y,q=n(18),K=n(5),Q=n(12),W=Object(b.default)(q.Row)(T||(T=Object(u.a)(["\n  margin: 2rem 0;\n"]))),X=b.default.div(_||(_=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n"]))),$=b.default.div(B||(B=Object(u.a)(["\n  display: flex;\n  margin-top: 1rem;\n  padding-right: 1rem;\n"]))),ee=b.default.div(F||(F=Object(u.a)(["\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  @media only screen and (max-width: 600px) {\n    right: 0rem;\n  }\n"]))),te=Object(b.default)(K.CardContent)(z||(z=Object(u.a)(["\n  position: relative;\n"]))),ne=Object(b.default)(K.TextBox)(E||(E=Object(u.a)(["\n  margin-bottom: 1rem;\n  text-align: center;\n"]))),ae=Object(b.default)(K.Card)(U||(U=Object(u.a)(["\n  margin: 1.5rem 2rem 0;\n  :last-of-type {\n    margin-bottom: 10rem;\n\n  }\n  @media only screen and (max-width: 600px) {\n    margin: 1rem 0rem 1rem 0;\n    padding-right: 1rem;\n  }\n"]))),re=function(e){for(var t=e.habitId,n=e.habitName,a=e.progressValue,r=e.maxValue,c=e.deleteHabit,i=e.habitProgress,o=e.updateActivity,s="".concat(a,"/").concat(r),u=new Date,b=["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],d=[],l=function(e){return"0".concat(e).slice(-2)},p=0;p<5;++p){var f=l(u.getDate()),m=l(u.getMonth()+1),h=u.getFullYear()+"-"+m+"-"+f+"T19:47:00.571Z";d.push([p,h,b[u.getDay()]]),u=new Date(u.getTime()-864e5)}return d=d.reverse(),Object(j.jsx)(ae,{children:Object(j.jsx)(K.CardBody,{children:Object(j.jsxs)(te,{children:[Object(j.jsx)(K.Container,{children:Object(j.jsxs)(W,{children:[Object(j.jsx)(K.Col,{type:"calc",size:6,children:Object(j.jsx)(K.TextBox,{size:"l",subTitle:s,title:n})}),Object(j.jsx)($,{children:d.map((function(e){return Object(j.jsxs)(K.Col,{type:"calc",size:.9,children:[Object(j.jsx)(ne,{size:"m",title:e[1].slice(5,10),subTitle:e[2]}),Object(j.jsx)(X,{children:Object(j.jsx)(K.Checkbox,{checked:void 0!=i?i[e[0]]:1,onChange:function(n){return o(t,e[1],n.target.checked)}})})]},e[0])}))})]})}),Object(j.jsx)(ee,{onClick:function(){c(t)},children:Object(j.jsx)(Q.h,{})})]})})})},ce=Object(b.default)(K.TextField)(P||(P=Object(u.a)(["\n  flex-grow: 1;\n  margin-right: 1rem;\n  \n  @media only screen and (max-width: 600px) {\n    margin-right: 0;\n  \n  }\n"]))),ie=b.default.div(R||(R=Object(u.a)(["\n  @media only screen and (max-width: 600px) {\n    display: flex;\n    align-items: center;\n    margin-top: 1rem;\n    margin-left: 1rem;\n  }\n"]))),oe=Object(b.default)(K.Card)(L||(L=Object(u.a)(["\n\n  width: 50%;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  padding: 2rem;\n  background-color: ",";\n  background-image: ",";\n  @media only screen and (max-width: 900px) {\n    width: 90%;\n  }\n\n"])),l.background,l.gradient),se=b.default.div(V||(V=Object(u.a)(["\n  display: flex;\n  margin: 2.5rem 0;\n  @media only screen and (max-width: 600px) {\n    margin: 2rem 0;\n    flex-direction: column;\n  }\n"]))),ue=Object(b.default)(K.TextBox)(G||(G=Object(u.a)(["\n  margin-bottom: 0.5rem;\n  @media only screen and (max-width: 900px) {\n    margin-right: 1rem\n  }\n"]))),be=function(e){var t=e.setPopupActive,n=e.createHabitCountState,a=e.createHabitNameState,r=e.setCreateHabitNameState,c=e.setCreateHabitCountState,i=(e.createHabitName,e.createHabbitAction);return Object(j.jsx)(oe,{children:Object(j.jsx)(K.CardBody,{children:Object(j.jsxs)(K.CardContent,{children:[Object(j.jsx)(K.TextBox,{size:"l",title:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438"}),Object(j.jsxs)(se,{children:[Object(j.jsx)(ce,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438",value:a,onChange:function(e){r(e.target.value)}}),Object(j.jsxs)(ie,{children:[Object(j.jsx)(ue,{size:"m",subTitle:"\u0412\u0440\u0435\u043c\u044f \u0432\u044b\u0440\u0430\u0431\u043e\u0442\u043a\u0438"}),Object(j.jsx)(K.Stepper,{step:1,value:n,onChange:function(e){c(e)}})]})]}),Object(j.jsx)(K.Button,{text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",view:"primary",onClick:function(){a&&(t(!1),i())}})]})})})},de=function(e){var t=e.onClick;return Object(j.jsx)(K.Button,{text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onClick:t,view:"clear"})},le=(b.default.div(J||(J=Object(u.a)(["\n    filter: blur(8px);\n    -webkit-filter: blur(8px);  \n"]))),b.default.div(Z||(Z=Object(u.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 4rem;\n    position: sticky;\n    top: 0;\n    background-color: rgba(0,0,0,.6);\n    -webkit-backdrop-filter: blur(10px);\n    backdrop-filter: blur(10px);\n    @media only screen and (max-width: 600px) {\n        padding: 1rem 1rem;\n    }\n    "])))),je=b.default.div(M||(M=Object(u.a)(["\n    height: 100vh;\n    width: 100vw;\n    background-color: rgba(0,0,0,.6);\n    position: fixed;\n    top: 0;\n    left: 0; \n"]))),pe=b.default.div(Y||(Y=Object(u.a)(["\n  position: absolute;\n  top:1rem;\n  right:1rem;\n"]))),fe=n(66);var me=function(){var e={notes:[]},t=Object(r.useState)(!1),n=Object(g.a)(t,2),a=n[0],i=n[1],o=Object(r.useRef)("1234555"),s=Object(r.useState)(0),u=Object(g.a)(s,2),b=u[0],d=(u[1],Object(r.useState)("\u041a\u0438\u0440\u0438\u043b\u043b1")),l=Object(g.a)(d,2),p=l[0],f=(l[1],Object(r.useState)(20)),m=Object(g.a)(f,2),h=m[0],v=(m[1],Object(r.useState)("\u041c")),y=Object(g.a)(v,2),k=y[0],C=(y[1],Object(r.useRef)("")),A=Object(r.useRef)(""),T=Object(r.useState)(""),_=Object(g.a)(T,2),B=_[0],F=_[1],z=Object(r.useState)(66),E=Object(g.a)(z,2),U=E[0],P=E[1],R=Object(r.useState)([]),L=Object(g.a)(R,2),V=L[0],G=L[1],J=Object(r.useState)([!1,!0,!1,!1,!1]),Z=Object(g.a)(J,2),M=(Z[0],Z[1],Object(r.useRef)());Object(r.useEffect)((function(){var e;M.current=(e=function(){return W()},Object(fe.a)({getState:e})),M.current.on("start",(function(e){console.log("assistant.on(start)",e)})),M.current.on("data",(function(e){"smart_app_data"==e.type&&(console.log("User"),console.log(e),void 0!=e.sub?(console.log("Sub",e.sub),o.current=e.sub,w(e.sub,b,p,h,k),S(e.sub).then((function(e){G(e)}))):void 0!=e.user_id&&(console.log("UserId",e.user_id),o.current=e.user_id,w(e.userId,b,p,h,k),S(e.user_id).then((function(e){G(e)})))),console.log("assistant.on(data)",e);var t=e.action;Y(t)}))}),[]),Object(r.useEffect)((function(){S(o.current).then((function(e){G(e)}))}),[o.current]),Object(r.useEffect)((function(){C.current=B}),[B]),Object(r.useEffect)((function(){A.current=U}),[U]);var Y=function(){var e=Object(x.a)(O.a.mark((function e(t){var n,r,c,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("dispatchAssistantAction",t),!t){e.next=28;break}e.t0=t.type,e.next="OpenCreateHabitForm"===e.t0?5:"setHabbitName"===e.t0?7:"setHabbitTime"===e.t0?10:"createHabit"===e.t0?12:"deleteHabit"===e.t0?13:"completeHabit"===e.t0?15:27;break;case 5:return i(!a),e.abrupt("break",28);case 7:return console.log(t.data),F(t.data),e.abrupt("break",28);case 10:return P(t.data),e.abrupt("break",28);case 12:C.current&&(i(!1),X());case 13:return q(t.data),e.abrupt("break",28);case 15:if(n=t.date.year,r=t.date.month,c=t.date.day,o="",console.log(t.data),V.map((function(e,n){var a=e._id;e.Name.toLowerCase()==t.data.toLowerCase()&&(o=a,console.log("HabitId"))})),""!=o){e.next=25;break}return e.abrupt("return");case 25:ee(o,n+"-"+r+"-"+c+"T19:47:00.571Z",!0);case 26:case 27:return e.abrupt("break",28);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){V.map((function(t,n){var a=t._id,r=t.Name;if(e.toLowerCase()==r.toLowerCase())return $(a),void M.current.sendData({action:{action_id:"successDelete"}})})),M.current.sendData({action:{action_id:"BadDelete"}})},W=function(){console.log("getStateForAssistant: state:",e);var t={item_selector:{items:e.notes.map((function(e,t){return{number:t+1,id:e.id,title:e.title}}))}};return console.log("getStateForAssistant: new_state:",t),t},X=function(){console.log("UserId",o.current),console.log("CreateHabit",C.current),console.log("Count",A),function(e,t,n){return H.apply(this,arguments)}(o.current,C.current,A.current).then((function(){return S(o.current).then((function(e){console.log(e),G(e),M.current.sendData({action:{action_id:"successAdd"}})}))})),C.current="",F(""),P(66),console.log(V)},$=function(e){(function(e){return D.apply(this,arguments)})(e).then((function(){return S(o.current).then((function(e){G(e)}))}))},ee=function(e,t,n){n?(function(e,t){return I.apply(this,arguments)}(e,t).then((function(){S(o.current).then((function(e){G(e)}))})),console.log("Add")):(function(e,t){return N.apply(this,arguments)}(e,t).then((function(){S(o.current).then((function(e){G(e)}))})),console.log("Delete"))};return Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsxs)(le,{children:[Object(j.jsx)(K.TextBox,{size:"l",title:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438:"}),Object(j.jsx)(de,{onClick:function(){i(!a),console.log(o.current)}})]}),V.map((function(e,t){var n=e._id,a=e.Name,r=e.DateForEnd,c=e.fivedays,i=e.progress;return Object(j.jsx)(re,{habitId:n,habitName:a,progressValue:i,maxValue:r,habitProgress:c,deleteHabit:$,updateActivity:ee})})),a?Object(j.jsxs)("div",{children:[Object(j.jsx)(je,{onClick:function(){return i(!a)}}),Object(j.jsx)(be,{setPopupActive:i,setCreateHabitCountState:P,createHabitNameState:B,setCreateHabitNameState:F,createHabitCountState:U,createHabitName:C,createHabbitAction:X}),Object(j.jsx)(pe,{onClick:function(){return i(!a)},children:Object(j.jsx)(Q.d,{})})]}):null]})};o.a.render(Object(j.jsxs)(s.DeviceThemeProvider,{children:[Object(j.jsx)(m,{}),Object(j.jsx)(me,{})]}),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.70ed841a.chunk.js.map