(this["webpackJsonphabit-tracker-sber-app-frontend"]=this["webpackJsonphabit-tracker-sber-app-frontend"]||[]).push([[0],{161:function(t,e,n){"use strict";n.r(e);var a,r=n(0),c=n.n(r),i=n(17),o=n.n(i),s=n(67),u=n(6),b=n(1),l=n(60),d=n(2),p=n(3),j=Object(b.createGlobalStyle)(a||(a=Object(u.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),d.text,d.background,d.gradient),f=Object(b.createGlobalStyle)(l.darkSber),m=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(j,{}),Object(p.jsx)(f,{})]})},h=n(9),O=n.n(h),x=n(14),g=n(13),v=n(16),y=n.n(v),k="https://desolate-badlands-87176.herokuapp.com/";function w(t,e,n,a,r){return C.apply(this,arguments)}function C(){return(C=Object(x.a)(O.a.mark((function t(e,n,a,r,c){var i,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.post(k+"user/",{UserId:e,SberId:n,Name:a,Age:r,Gender:c});case 2:return i=t.sent,o=i.data,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(){return(H=Object(x.a)(O.a.mark((function t(e,n,a){var r,c;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.post(k+"habit",{UserId:e,Name:n,DateForEnd:a});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(t){return D.apply(this,arguments)}function D(){return(D=Object(x.a)(O.a.mark((function t(e){var n,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.get(k+"habit/",{params:{UserId:e}});case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function A(){return(A=Object(x.a)(O.a.mark((function t(e){var n,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.delete(k+"habit?HabitId="+"".concat(e));case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(){return(T=Object(x.a)(O.a.mark((function t(e,n){var a,r,c;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={HabitId:e,DateOfActivity:n},console.log("body:",a),t.next=4,y.a.post(k+"activity",a);case 4:return r=t.sent,c=r.data,t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(){return(_=Object(x.a)(O.a.mark((function t(e,n){var a,r,c;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={HabitId:e,DateOfActivity:n},console.log("body:",a),t.next=4,y.a.delete("".concat(k,"activity?HabitId=").concat(e,"&DateOfActivity=").concat(n));case 4:return r=t.sent,c=r.data,t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var I,N,B,F,z,E,U,L,P,R,V,G,J,Z,M,Y,q=n(18),K=n(5),Q=n(12),W=Object(b.default)(q.Row)(I||(I=Object(u.a)(["\n  margin: 2rem 0;\n"]))),X=b.default.div(N||(N=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n"]))),$=(b.default.div(B||(B=Object(u.a)(["\n  display: flex;\n  margin-top: 1rem;\n  padding-right: 1rem;\n"]))),b.default.div(F||(F=Object(u.a)(["\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  @media only screen and (max-width: 600px) {\n    right: 0rem;\n  }\n"])))),tt=Object(b.default)(K.CardContent)(z||(z=Object(u.a)(["\n  position: relative;\n"]))),et=Object(b.default)(K.TextBox)(E||(E=Object(u.a)(["\n  margin-bottom: 1rem;\n  text-align: center;\n"]))),nt=Object(b.default)(K.Card)(U||(U=Object(u.a)(["\n  margin: 1.5rem 2rem 0;\n  :last-of-type {\n    margin-bottom: 10rem;\n  }\n  @media only screen and (max-width: 600px) {\n    margin: 1rem 0rem 1rem 0;\n    padding-right: 1rem;\n  }\n"]))),at=function(t){for(var e=t.habitId,n=t.habitName,a=t.progressValue,r=t.maxValue,c=t.deleteHabit,i=t.habitProgress,o=t.updateActivity,s="".concat(a,"/").concat(r),u=new Date,b=["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],l=[],d=function(t){return"0".concat(t).slice(-2)},j=0;j<5;++j){var f=d(u.getDate()),m=d(u.getMonth()+1),h=u.getFullYear()+"-"+m+"-"+f+"T19:47:00.571Z";l.push([j,h,b[u.getDay()]]),u=new Date(u.getTime()-864e5)}return l=l.reverse(),Object(p.jsx)(nt,{children:Object(p.jsx)(K.CardBody,{children:Object(p.jsxs)(tt,{children:[Object(p.jsx)(K.Container,{children:Object(p.jsxs)(W,{children:[Object(p.jsx)(K.Col,{type:"calc",size:6,children:Object(p.jsx)(K.TextBox,{size:"l",subTitle:s,title:n})}),l.map((function(t){return Object(p.jsxs)(K.Col,{type:"calc",size:1,children:[Object(p.jsx)(et,{size:"m",title:t[1].slice(5,10),subTitle:t[2]}),Object(p.jsx)(X,{children:Object(p.jsx)(K.Checkbox,{checked:void 0!=i?i[t[0]]:1,onChange:function(n){return o(e,t[1],n.target.checked)}})})]},t[0])}))]})}),Object(p.jsx)($,{onClick:function(){c(e)},children:Object(p.jsx)(Q.h,{})})]})})})},rt=Object(b.default)(K.TextField)(L||(L=Object(u.a)(["\n  flex-grow: 1;\n  margin-right: 1rem;\n  \n  @media only screen and (max-width: 600px) {\n    margin-right: 0;\n  \n  }\n"]))),ct=(b.default.div(P||(P=Object(u.a)(["\n  @media only screen and (max-width: 600px) {\n    display: flex;\n    align-items: center;\n    margin-top: 1rem;\n    margin-left: 1rem;\n  }\n"]))),Object(b.default)(K.Card)(R||(R=Object(u.a)(["\n  width: 50%;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  padding: 2rem;\n  background-color: ",";\n  background-image: ",";\n  @media only screen and (max-width: 900px) {\n    width: 90%;\n  }\n"])),d.background,d.gradient)),it=b.default.div(V||(V=Object(u.a)(["\n  display: flex;\n  margin: 2.5rem 0;\n  @media only screen and (max-width: 600px) {\n    margin: 2rem 0;\n    flex-direction: column;\n  }\n"]))),ot=Object(b.default)(K.TextBox)(G||(G=Object(u.a)(["\n  margin-bottom: 0.5rem;\n  @media only screen and (max-width: 900px) {\n    margin-right: 1rem\n  }\n"]))),st=function(t){var e=t.setPopupActive,n=t.createHabitCountState,a=t.createHabitNameState,r=t.setCreateHabitNameState,c=t.setCreateHabitCountState,i=(t.createHabitName,t.createHabbitAction);return Object(p.jsx)(ct,{children:Object(p.jsx)(K.CardBody,{children:Object(p.jsxs)(K.CardContent,{children:[Object(p.jsx)(K.TextBox,{size:"l",title:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438"}),Object(p.jsxs)(it,{children:[Object(p.jsx)(rt,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438",value:a,onChange:function(t){r(t.target.value)}}),Object(p.jsxs)("div",{children:[Object(p.jsx)(ot,{size:"m",subTitle:"\u0412\u0440\u0435\u043c\u044f \u0432\u044b\u0440\u0430\u0431\u043e\u0442\u043a\u0438"}),Object(p.jsx)(K.Stepper,{step:1,value:n,onChange:function(t){c(t)}})]})]}),Object(p.jsx)(K.Button,{text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",view:"primary",onClick:function(){a&&(e(!1),i())}})]})})})},ut=function(t){var e=t.onClick;return Object(p.jsx)(K.Button,{text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:e,view:"clear"})},bt=(b.default.div(J||(J=Object(u.a)(["\n    filter: blur(8px);\n    -webkit-filter: blur(8px);  \n"]))),b.default.div(Z||(Z=Object(u.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 4rem;\n    position: sticky;\n    top: 0;\n    background-color: rgba(0,0,0,.6);\n    -webkit-backdrop-filter: blur(10px);\n    backdrop-filter: blur(10px);\n    @media only screen and (max-width: 600px) {\n        padding: 1rem 1rem;\n    }\n    "])))),lt=b.default.div(M||(M=Object(u.a)(["\n    height: 100vh;\n    width: 100vw;\n    background-color: rgba(0,0,0,.6);\n    position: fixed;\n    top: 0;\n    left: 0; \n"]))),dt=b.default.div(Y||(Y=Object(u.a)(["\n  position: absolute;\n  top:1rem;\n  right:1rem;\n"]))),pt=n(66);var jt=function(){var t={notes:[]},e=Object(r.useState)(!1),n=Object(g.a)(e,2),a=n[0],i=n[1],o=Object(r.useRef)("1234555"),s=Object(r.useState)(0),u=Object(g.a)(s,2),b=u[0],l=(u[1],Object(r.useState)("\u041a\u0438\u0440\u0438\u043b\u043b1")),d=Object(g.a)(l,2),j=d[0],f=(d[1],Object(r.useState)(20)),m=Object(g.a)(f,2),h=m[0],v=(m[1],Object(r.useState)("\u041c")),y=Object(g.a)(v,2),k=y[0],C=(y[1],Object(r.useRef)("")),D=Object(r.useRef)(""),I=Object(r.useState)(""),N=Object(g.a)(I,2),B=N[0],F=N[1],z=Object(r.useState)(1),E=Object(g.a)(z,2),U=E[0],L=E[1],P=Object(r.useState)([]),R=Object(g.a)(P,2),V=R[0],G=R[1],J=Object(r.useState)([!1,!0,!1,!1,!1]),Z=Object(g.a)(J,2),M=(Z[0],Z[1],Object(r.useRef)());Object(r.useEffect)((function(){var t;M.current=(t=function(){return W()},Object(pt.a)({getState:t})),M.current.sendData({action:{action_id:"startApp"}}),M.current.on("start",(function(t){console.log("assistant.on(start)",t)})),M.current.on("data",(function(t){"smart_app_data"==t.type&&(console.log("User"),console.log(t),void 0!=t.sub?(console.log("Sub",t.sub),o.current=t.sub,w(t.sub,b,j,h,k),S(t.sub).then((function(t){G(t)}))):void 0!=t.user_id&&(console.log("UserId",t.user_id),o.current=t.user_id,w(t.userId,b,j,h,k),S(t.user_id).then((function(t){G(t)})))),console.log("assistant.on(data)",t);var e=t.action;Y(e)}))}),[]),Object(r.useEffect)((function(){S(o.current).then((function(t){G(t)}))}),[o.current]),Object(r.useEffect)((function(){C.current=B}),[B]),Object(r.useEffect)((function(){D.current=U}),[U]);var Y=function(){var t=Object(x.a)(O.a.mark((function t(e){var n,r,c,s;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("dispatchAssistantAction",e),!e){t.next=27;break}t.t0=e.type,t.next="OpenCreateHabitForm"===t.t0?5:"setHabbitName"===t.t0?7:"setHabbitTime"===t.t0?10:"createHabit"===t.t0?15:"deleteHabit"===t.t0?17:"completeHabit"===t.t0?19:26;break;case 5:return i(!a),t.abrupt("break",27);case 7:return console.log(e.data),F(e.data),t.abrupt("break",27);case 10:if(!(e.data<=0)){t.next=13;break}return M.current.sendData({action:{action_id:"wrongHabitTime"}}),t.abrupt("break",27);case 13:return L(e.data),t.abrupt("break",27);case 15:return C.current?(i(!1),X()):a&&M.current.sendData({action:{action_id:"emptyHabitName"}}),t.abrupt("break",27);case 17:return""!=e.data&&(q(e.data),console.log("Delete habit",e.data)),t.abrupt("break",27);case 19:return n=e.date.year,r=e.date.month,c=e.date.day,s="",console.log(e.data),S(o.current).then((function(t){t.map((function(t,n){var a=t._id,r=t.Name;console.log(r.toLowerCase()),r.toLowerCase().trim()==e.data.toLowerCase().trim()&&(s=a,console.log("HabitId"))})),""!=s&&tt(s,n+"-"+r+"-"+c+"T19:47:00.571Z",!0)})),t.abrupt("break",27);case 26:return t.abrupt("break",27);case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),q=function(t){console.log(V),S(o.current).then((function(e){var n="BadDelete";e.map((function(e,a){var r=e._id,c=e.Name;t.toLowerCase().trim()==c.toLowerCase().trim()&&(n="successDelete",$(r))})),M.current.sendData({action:{action_id:n}})}))},W=function(){console.log("getStateForAssistant: state:",t);var e={item_selector:{items:t.notes.map((function(t,e){return{number:e+1,id:t.id,title:t.title}}))}};return console.log("getStateForAssistant: new_state:",e),e},X=function(){console.log("UserId",o.current),console.log("CreateHabit",C.current),console.log("Count",D);var t=C.current[0].toUpperCase()+C.current.substring(1);(function(t,e,n){return H.apply(this,arguments)})(o.current,t,D.current).then((function(){return S(o.current).then((function(e){console.log(e),G(e),M.current.sendData({action:{action_id:"howToCompleteHabit",parameters:{text:"\u041f\u0440\u0438\u0432\u044b\u0447\u043a\u0430 \u0443\u0434\u0430\u0447\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430. \u0427\u0442\u043e\u0431\u044b \u043e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 \u043d\u0443\u0436\u043d\u043e \u0441\u043a\u0430\u0437\u0430\u0442\u044c: \u0412\u044b\u043f\u043e\u043b\u043d\u0438\u043b \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0443  ".concat(t," \u0441\u0435\u0433\u043e\u0434\u043d\u044f. \u0412\u043c\u0435\u0441\u0442\u043e \u0441\u0435\u0433\u043e\u0434\u043d\u044f \u043c\u043e\u0436\u043d\u043e \u043d\u0430\u0437\u0432\u0430\u0442\u044c \u0434\u0430\u0442\u0443, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043f\u0435\u0440\u0432\u043e\u0435 \u043c\u0430\u044f.")}}})}))})),C.current="",F(""),L(1),console.log(V)},$=function(t){console.log("DeleteHabitAction",t),function(t){return A.apply(this,arguments)}(t).then((function(){return S(o.current).then((function(t){G(t)}))}))},tt=function(t,e,n){n?(function(t,e){return T.apply(this,arguments)}(t,e).then((function(){S(o.current).then((function(t){G(t)}))})),console.log("Add")):(function(t,e){return _.apply(this,arguments)}(t,e).then((function(){S(o.current).then((function(t){G(t)}))})),console.log("Delete"))};return Object(p.jsxs)(c.a.Fragment,{children:[Object(p.jsxs)(bt,{children:[Object(p.jsx)(K.TextBox,{size:"l",title:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438:"}),Object(p.jsx)(ut,{onClick:function(){i(!a),console.log(o.current)}})]}),V.map((function(t,e){var n=t._id,a=t.Name,r=t.DateForEnd,c=t.fivedays,i=t.progress;return Object(p.jsx)(at,{habitId:n,habitName:a,progressValue:i,maxValue:r,habitProgress:c,deleteHabit:$,updateActivity:tt})})),a?Object(p.jsxs)("div",{children:[Object(p.jsx)(lt,{onClick:function(){return i(!a)}}),Object(p.jsx)(st,{setPopupActive:i,setCreateHabitCountState:L,createHabitNameState:B,setCreateHabitNameState:F,createHabitCountState:U,createHabitName:C,createHabbitAction:X}),Object(p.jsx)(dt,{onClick:function(){return i(!a)},children:Object(p.jsx)(Q.d,{})})]}):null]})};o.a.render(Object(p.jsxs)(s.DeviceThemeProvider,{children:[Object(p.jsx)(m,{}),Object(p.jsx)(jt,{})]}),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.79e3be2e.chunk.js.map